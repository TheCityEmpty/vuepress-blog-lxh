<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1.0之了解vue3的改动 | 江湖录</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="vue3 项目初始化，了解些vue3重要的改动以及变化">
    
    <link rel="preload" href="/vuepress-blog-lxh/assets/css/0.styles.253d253c.css" as="style"><link rel="preload" href="/vuepress-blog-lxh/assets/js/app.8d32188a.js" as="script"><link rel="preload" href="/vuepress-blog-lxh/assets/js/2.ae6c3983.js" as="script"><link rel="preload" href="/vuepress-blog-lxh/assets/js/33.d86bcecd.js" as="script"><link rel="preload" href="/vuepress-blog-lxh/assets/js/6.b516d596.js" as="script"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/10.362c3091.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/11.d9f79592.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/12.8d36d4e0.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/13.7663dd42.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/14.616766c6.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/15.a80cddf5.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/16.8d635d16.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/17.0e2f7697.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/18.ad92e712.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/19.9a616bcd.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/20.f70dd27d.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/21.ead17315.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/22.4adc24b8.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/23.741273c3.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/24.960c4de1.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/25.71255207.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/26.99bdf89d.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/27.a7cfdd9f.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/28.73ce90d6.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/29.86001c69.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/3.0d3a7d18.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/30.f7879cbd.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/31.378c1464.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/32.7569ba20.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/34.f8189bcb.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/35.ca59a7c5.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/4.1c645c93.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/5.d5f27362.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/7.26863545.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/8.35a881dd.js"><link rel="prefetch" href="/vuepress-blog-lxh/assets/js/9.fd4b449d.js">
    <link rel="stylesheet" href="/vuepress-blog-lxh/assets/css/0.styles.253d253c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress-blog-lxh/" class="home-link router-link-active"><img src="/vuepress-blog-lxh/logo.svg" alt="江湖录" class="logo"> <span class="site-name can-hide">江湖录</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuepress-blog-lxh/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/vuepress-blog-lxh/other-pages/category.html" class="nav-link">
  文章分类
</a></div> <a href="https://github.com/TheCityEmpty/vuepress-blog-lxh/tree/code" target="_blank" rel="noopener noreferrer" class="repo-link">
    github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuepress-blog-lxh/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/vuepress-blog-lxh/other-pages/category.html" class="nav-link">
  文章分类
</a></div> <a href="https://github.com/TheCityEmpty/vuepress-blog-lxh/tree/code" target="_blank" rel="noopener noreferrer" class="repo-link">
    github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>1.0之了解vue3的改动</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuepress-blog-lxh/vue3/vue3-1.project-init.html#项目初始化" class="sidebar-link">项目初始化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog-lxh/vue3/vue3-1.project-init.html#通过-vue-cli-来创建项目" class="sidebar-link">通过 vue-cli 来创建项目</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog-lxh/vue3/vue3-1.project-init.html#通过-vite-来创建项目" class="sidebar-link">通过 vite 来创建项目</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog-lxh/vue3/vue3-1.project-init.html#这里将列出-vue3-现在的所有新功能或新特性或重大改动" class="sidebar-link">这里将列出 vue3 现在的所有新功能或新特性或重大改动</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog-lxh/vue3/vue3-1.project-init.html#_1-最重要的当然是-组合式-api-也就是-composition-api。" class="sidebar-link" style="padding-left:3rem;">1. 最重要的当然是 组合式 API, 也就是 composition API。</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog-lxh/vue3/vue3-1.project-init.html#_2-新增了一个-teleport-组件-传送组件" class="sidebar-link" style="padding-left:3rem;">2. 新增了一个 Teleport 组件， 传送组件</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog-lxh/vue3/vue3-1.project-init.html#_3-每个组件将不再只能有一个根节点了-vue3-允许你写多个根节点。" class="sidebar-link" style="padding-left:3rem;">3. 每个组件将不再只能有一个根节点了， vue3 允许你写多个根节点。</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog-lxh/vue3/vue3-1.project-init.html#_4-全局-vue-api-已更改为使用应用程序实例" class="sidebar-link" style="padding-left:3rem;">4. 全局 Vue API 已更改为使用应用程序实例</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog-lxh/vue3/vue3-1.project-init.html#_5-全局和内部-api-已经被重构为可-tree-shakable" class="sidebar-link" style="padding-left:3rem;">5. 全局和内部 API 已经被重构为可 tree-shakable</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog-lxh/vue3/vue3-1.project-init.html#_6-组件上-v-model-用法已更改" class="sidebar-link" style="padding-left:3rem;">6. 组件上 v-model 用法已更改</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog-lxh/vue3/vue3-1.project-init.html#_7-使用-template-template-元素进行循环输出时-key-属性现在可以绑定在-template-元素上了" class="sidebar-link" style="padding-left:3rem;">7. 使用 &lt;template&gt;&lt;/template&gt; 元素进行循环输出时，key 属性现在可以绑定在 template 元素上了</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog-lxh/vue3/vue3-1.project-init.html#_8-v-bind-排序问题" class="sidebar-link">8. v-bind 排序问题</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog-lxh/vue3/vue3-1.project-init.html#_9-vue3-移除了-v-on-native-修饰符" class="sidebar-link">9. vue3 移除了 v-on.native 修饰符</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog-lxh/vue3/vue3-1.project-init.html#_10-vue3-中-ref-更改" class="sidebar-link">10. vue3 中 ref=&quot;&quot; 更改</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog-lxh/vue3/vue3-1.project-init.html#_11-渲染函数更改" class="sidebar-link">11. 渲染函数更改</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog-lxh/vue3/vue3-1.project-init.html#_12-自定义指令的生命周期进行了更改" class="sidebar-link">12. 自定义指令的生命周期进行了更改</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_1-0之了解vue3的改动"><a href="#_1-0之了解vue3的改动" class="header-anchor">#</a> 1.0之了解vue3的改动</h1> <p><code>vue3</code> 的版本现在也已经发布了正式版本，这就说明之后不管怎么变动都不会太大，只会打点补丁新增写特性之类的。而其他一些 <code>vue</code> 的相关配件， 如 <code>vuex</code> , <code>vue-router</code>, <code>vue-cli</code> 等都处于 <code>beta</code> 状态了。在这个时候， <code>vue3</code> 可能还不会大规模的使用， 但是我们也需要开始学习了。因为 <code>vue3</code> 真的是太棒了。</p> <p><strong>以下所有 <code>vue2</code> 指 <code>vue2.x版本</code> ，而 <code>vue3</code> 指 <code>vue3.x版本</code></strong></p> <h2 id="项目初始化"><a href="#项目初始化" class="header-anchor">#</a> 项目初始化</h2> <p>一般来说有两种方式来创建项目。</p> <h3 id="通过-vue-cli-来创建项目"><a href="#通过-vue-cli-来创建项目" class="header-anchor">#</a> 通过 <code>vue-cli</code> 来创建项目</h3> <p>一个是以 <code>vue2</code> 的方式通过 <code>vue-cli</code> 来创建。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 使用npm</span>
<span class="token function">npm</span> <span class="token function">install</span> -g @vue/cli 

<span class="token comment"># 使用yarn</span>
<span class="token comment"># yarn global add @vue/cli</span>

<span class="token comment"># vue create [project-name]</span>
vue create vue3-project
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>输入命令后按下回车， 会出现让你选择预设，但是可以看到第二个选项是 <code>Default (Vue 3 Preview) ([Vue 3] babel, eslint)</code> ，采用 <code>vue3</code> 的默认模板。我们就可以选择它。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>? Please pick a preset: <span class="token punctuation">(</span>Use arrow keys<span class="token punctuation">)</span>
<span class="token operator">&gt;</span> Default <span class="token punctuation">(</span><span class="token punctuation">[</span>Vue <span class="token number">2</span><span class="token punctuation">]</span> babel, eslint<span class="token punctuation">)</span>
  Default <span class="token punctuation">(</span>Vue <span class="token number">3</span> Preview<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>Vue <span class="token number">3</span><span class="token punctuation">]</span> babel, eslint<span class="token punctuation">)</span>
  Manually <span class="token keyword">select</span> features
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>接下来就会开始自动安装了。然后我们进去这个目录， 并运行项目。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> vue3-project
<span class="token function">yarn</span> serve
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>等待项目编译完成后， 我们就可以在浏览器输入 <code>http://localhost:8080/</code>（如果你的8080端口没被占用的话，就算被占用了，<code>vue-cli</code> 也会给你分配一个未被占用的端口） 来访问你的项目了。</p> <h3 id="通过-vite-来创建项目"><a href="#通过-vite-来创建项目" class="header-anchor">#</a> 通过 <code>vite</code> 来创建项目</h3> <p><code>vite</code> 是一个通过原生 <code>ES Module</code> 提供服务的。理论上这个会比使用 <code>webpack</code> 构建来的块， 但是兼容性也是一个问题，所以暂时不使用它。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 使用npm</span>
<span class="token function">npm</span> init vite-app hello-vue3

<span class="token comment"># 使用yarn</span>
<span class="token comment"># yarn create vite-app hello-vue3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="这里将列出-vue3-现在的所有新功能或新特性或重大改动"><a href="#这里将列出-vue3-现在的所有新功能或新特性或重大改动" class="header-anchor">#</a> 这里将列出 <code>vue3</code> 现在的所有新功能或新特性或重大改动</h3> <h4 id="_1-最重要的当然是-组合式-api-也就是-composition-api。"><a href="#_1-最重要的当然是-组合式-api-也就是-composition-api。" class="header-anchor">#</a> 1. 最重要的当然是 <strong>组合式 API</strong>, 也就是 <code>composition API</code>。</h4> <p>为啥要将原先的 <code>options API</code> 可选项 API，更改为 <code>composition API</code> 组合式 API。</p> <p>刚实验使用 <code>composition API</code> 的时候我也想过，因为真的太麻烦了。创建响应式数据我需要引入函数，使用生命周期我需要引入函数，使用计算属性我需要引入函数。但是在真的熟练使用后我觉得真的不错，因为相比于原先的数据与这条数据相关的逻辑是分离，现在的 <code>composition API</code> 可以使得数据与这条数据相关的逻辑是在一起的，这将更好维护代码。</p> <p>假设有这样一段代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 这是 vue2 的代码</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token comment">// 查询列表</span>
      tableData<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token comment">// 新增行</span>
      isAddSucess<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token comment">// 删除行</span>
      isDeleteSucess<span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">queryData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 查询列表</span>
    <span class="token function">queryData</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>tableData <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 新增方法</span>
    <span class="token function">addTable</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>isAddSucess <span class="token operator">=</span> <span class="token boolean">false</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span>tableData<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span>isAddSucess <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 删除方法</span>
    <span class="token function">deleteTbale</span> <span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>isDeleteSucess <span class="token operator">=</span> <span class="token boolean">false</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>tableData<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">0</span> <span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>isDeleteSucess <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p>这个时候我们就会发现一个很严重的问题， 数据在上面， 而跟数据相关的逻辑代码在下面，当整个组件很复杂的时候会发现整个代码是难以维护的。</p> <p><strong>而 <code>composition API</code> 就是来解决这个问题的</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 这是 vue3 的代码</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> reactive<span class="token punctuation">,</span> ref<span class="token punctuation">,</span> isReactive <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'App'</span><span class="token punctuation">,</span>
  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> tableData <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> isAddSucess <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> isDeleteSucess <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token function">queryData</span><span class="token punctuation">(</span>tableData<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      tableData<span class="token punctuation">,</span>
      isAddSucess<span class="token punctuation">,</span>
      isDeleteSucess<span class="token punctuation">,</span>
      <span class="token function-variable function">add</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">addTable</span><span class="token punctuation">(</span>tableData<span class="token punctuation">,</span> isAddSucess<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function-variable function">deleted</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">deleteTable</span><span class="token punctuation">(</span>tableData<span class="token punctuation">,</span> isDeleteSucess<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 查询列表</span>
<span class="token keyword">function</span> <span class="token function">queryData</span> <span class="token punctuation">(</span><span class="token parameter">tableData</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  tableData <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 新增方法</span>
<span class="token keyword">function</span> <span class="token function">addTable</span> <span class="token punctuation">(</span><span class="token parameter">tableData<span class="token punctuation">,</span> isAddSucess</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  isAddSucess<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span>

  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> addData <span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span>
    tableData<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">...</span>addData<span class="token punctuation">)</span>
    isAddSucess<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 删除方法</span>
<span class="token keyword">function</span> <span class="token function">deleteTable</span> <span class="token punctuation">(</span><span class="token parameter">tableData<span class="token punctuation">,</span> isDeleteSucess</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  isDeleteSucess<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span>

  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    tableData<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    isDeleteSucess<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><p><strong>好吧，代码写的并不是很好， 因为我不太会。所以确实有一定的学习成本，并不是一开始就能写一个很好地代码的。</strong></p> <h4 id="_2-新增了一个-teleport-组件-传送组件"><a href="#_2-新增了一个-teleport-组件-传送组件" class="header-anchor">#</a> 2. 新增了一个 <code>Teleport</code> 组件， 传送组件</h4> <p>在 <code>Vue</code> 中， 我们需要将所有 <code>dom</code> 都放置在 <code>&lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</code> 中。这样并不好， 这样会增加 <code>dom</code> 得到层级，而层级越深则性能越差。而且当我们想将某个组件创建在 <code>body</code> 下时就犯难了。</p> <p>原来的我们会这样做：</p> <p>这样我们将将一个组件插入到了 <code>body</code> 下了</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Message <span class="token keyword">from</span> <span class="token string">'./Message.vue'</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token comment">// 创建一个基于 Vue 的子类， 并将其挂载， 通过原生 DOM API 把它插入文档中</span>
<span class="token keyword">let</span> MessageConstructor <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>Message<span class="token punctuation">)</span>
<span class="token keyword">let</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MessageConstructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
instance<span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span>$el<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>现在我们可以这样做了：</p> <p>使用这个组件，它将自动将组件内容插入到 <code>to</code> 属性中的 <code>dom</code> 节点下</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>teleport</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>body<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
 /*  消息组件内容 */
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>teleport</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_3-每个组件将不再只能有一个根节点了-vue3-允许你写多个根节点。"><a href="#_3-每个组件将不再只能有一个根节点了-vue3-允许你写多个根节点。" class="header-anchor">#</a> 3. 每个组件将不再只能有一个根节点了， <code>vue3</code> 允许你写多个根节点。</h4> <h4 id="_4-全局-vue-api-已更改为使用应用程序实例"><a href="#_4-全局-vue-api-已更改为使用应用程序实例" class="header-anchor">#</a> 4. 全局 <code>Vue API</code> 已更改为使用应用程序实例</h4> <p>这句话啥意思呢？ 可以看到下面 <code>vue2</code> 和 <code>vue3</code> 通过不同的方式创建了实例。
在 <code>vue2</code> 中，是通过同一个构造函数来创建实例的， 并且是通过这个构造函数来设置全局配置的。这样对于多个实例来说， 这些全局配置是共享的。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// vue2 的写法</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  el<span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token parameter">h</span> <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$http <span class="token operator">=</span> http

<span class="token comment">// $http 方法是共享的</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment">// 能找到 $http 方法</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token comment">// 能找到 $http 方法</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// vue3 的写法</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>globalProperties<span class="token punctuation">.</span>$http <span class="token operator">=</span> http

<span class="token comment">// $http 方法不是共享的</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span> <span class="token comment">// 能找到 $http 方法</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token comment">// 不能找到 $http 方法</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="_5-全局和内部-api-已经被重构为可-tree-shakable"><a href="#_5-全局和内部-api-已经被重构为可-tree-shakable" class="header-anchor">#</a> 5. 全局和内部 <code>API</code> 已经被重构为可 <code>tree-shakable</code></h4> <p>什么叫 <code>tree-shakable</code> ？</p> <p>如下 <code>utils.js</code> 文件中有 <code>a</code>,<code>b</code>,<code>c</code> 三个方法， 但是在 <code>main.js</code> 中我们只用到了 <code>a</code>,<code>b</code>方法。</p> <p><strong>那么最终的打包文件中， <code>c</code> 方法将会被剔除出去，只留下了被使用过的<code>a</code>,<code>b</code>方法。这就叫<code>tree-shakable</code>，留下用过的，没用过的剔除出去。</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// utils.js</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">c</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// main.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> a<span class="token punctuation">,</span> b <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./utils.js'</span>
<span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>为什么说是重构为可<code>tree-shakable</code>？</p> <p>在 <code>vue2</code> 中，我们使用了一些方法</p> <p>然后发现了一个问题，所有的方法都是绑定到 <code>this</code> 上，导致打包后不管它们是否使用， 都将包含在最终代码中。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// vue2 写法</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$set</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'count'</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nexTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// todo</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>而在 <code>vue3</code> 中，都是作为 ES 模块构建的命名导出进行访问。如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// vue3 写法</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> nextTick <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 一些和DOM有关的东西</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_6-组件上-v-model-用法已更改"><a href="#_6-组件上-v-model-用法已更改" class="header-anchor">#</a> 6. 组件上 <code>v-model</code> 用法已更改</h4> <p>在 <code>vue2</code> 中使用自定义组件时：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table-component</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tableData<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table-component</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 是以下的简写: --&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table-component</span> <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tableData<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@input</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tableData = $event<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table-component</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// table-component.vue</span>
<span class="token comment">// vue2 写法</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    value<span class="token operator">:</span> Array<span class="token punctuation">,</span>
    <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">deleteData</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// ...todo</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>可以发现， 我们必须按照文档上的方式写成属性名为 <code>value</code>， 和 事件名为 <code>input</code>。</p> <p>并且当属性名 <code>value</code> 和 事件名 <code>input</code> 被占用的时候，这时候将非常麻烦，幸好在 <code>vue 2.2</code> 中引入了 <code>model</code> 组件选项，允许组件自定义用于 <code>v-model</code> 的 <code>prop</code> 和事件。但是，这仍然只允许在组件上使用一个 <code>model</code>。</p> <p>更改属性或事件名称，需要在 <code>table-component</code> 组件中添加 <code>model</code> 选项：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// table-component.vue</span>
<span class="token comment">// vue2 写法</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  model<span class="token operator">:</span> <span class="token punctuation">{</span>
    prop<span class="token operator">:</span> <span class="token string">'data'</span><span class="token punctuation">,</span>
    event<span class="token operator">:</span> <span class="token string">'dataChange'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  props<span class="token operator">:</span> <span class="token punctuation">{</span>
     <span class="token comment">// 使用 `data` 代替 `value` 作为 model 的 prop</span>
    data<span class="token operator">:</span> Array
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token comment">// 这将允许 value 用做其他作用</span>
      value<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">deleteData</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// ...todo</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'dataChange'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>现在让我们用 <code>vue3</code> 的方式写一个组件：</p> <ul><li>现在自定义一个组件，<code>v-model</code> prop 和事件默认名称已更改：
<ul><li>prop：<code>value</code> -&gt; <code>modelValue</code></li> <li>event：<code>input</code> -&gt; <code>update:modelValue</code></li></ul></li></ul> <p>(我们将不再受到 <code>value</code>属性 和 <code>input</code> 事件名冲突的困扰了)</p> <ul><li><code>v-bind</code> 的 <code>.sync</code> 修饰符和组件的 <code>model</code> 选项已移除</li></ul> <p>(当我们使用 <code>.sync</code> 时，<code>vue</code> 会给我们抛出一个错误， <code>error '.sync' modifier on 'v-bind' directive is deprecated. Use 'v-model:propName' instead</code>， 它告诉我们，<code>.sync</code> 已被移除， 请使用 <code>v-model:propName</code> 方式 )
(而使用 <code>model</code> 选项时， 它已经不生效了， 但是也没有错误。)</p> <ul><li>现在可以在同一个组件上使用多个 <code>v-model</code> 进行双向绑定</li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>loading</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isloading<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">v-model:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>loadingText<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>loading</span><span class="token punctuation">&gt;</span></span>
// this.isloading = true
// this.loadingText = 'loading...'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// vue3 写法</span>
<span class="token comment">// loading.vue</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    modelValue<span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
    text<span class="token operator">:</span> String
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  emits<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'update:modelValue'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token comment">// Proxy {modelValue: true}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="_7-使用-template-template-元素进行循环输出时-key-属性现在可以绑定在-template-元素上了"><a href="#_7-使用-template-template-元素进行循环输出时-key-属性现在可以绑定在-template-元素上了" class="header-anchor">#</a> 7. 使用 <code>&lt;template&gt;&lt;/template&gt;</code> 元素进行循环输出时，<code>key</code> 属性现在可以绑定在 <code>template</code> 元素上了</h4> <p><code>vue2</code> 中我们只能将 <code>key</code> 属性绑定在真实的节点上，如下就是 <code>div</code> 上， 如果绑定在 <code>template</code> 元素上则会报错：</p> <p><code>&lt;template&gt; cannot be keyed. Place the key on real elements instead</code></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- vue2 写法 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(item, index) in arr<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>而在 <code>vue3</code> 中，我们可以绑定在 <code>template</code> 元素上。如果绑定在 <code>div</code> 标签上则会报错：</p> <p><code>&lt;template v-for&gt; key should be placed on the &lt;template&gt; tag</code></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- vue3 写法 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(item, index) in arr<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_8-v-bind-排序问题"><a href="#_8-v-bind-排序问题" class="header-anchor">#</a> 8. <code>v-bind</code> 排序问题</h3> <p>在平常写一个组件的时候，我们可能需要将用户传递过来的 <code>v-bind</code> 进行覆盖组件的属性。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- vue2 写法 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>a<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-bind</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{ id: <span class="token punctuation">'</span>b<span class="token punctuation">'</span> }<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 或者这种写法 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-bind</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{ id: <span class="token punctuation">'</span>b<span class="token punctuation">'</span> }<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>a<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>最终渲染出来的结果都是：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>a<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>而我们期待的是，<code>id</code> b 覆盖 <code>id</code> a。</p> <p>而在 <code>vue3</code> 中修改了这种写法的逻辑， 将渲染最后出现的属性：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- vue3 写法 --&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>a<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-bind</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{ id: <span class="token punctuation">'</span>b<span class="token punctuation">'</span> }<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 渲染结果 ↓ --&gt;</span>
<span class="token comment">&lt;!-- &lt;div id=&quot;b&quot;&gt;&lt;/div&gt; --&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-bind</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{ id: <span class="token punctuation">'</span>b<span class="token punctuation">'</span> }<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>a<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 渲染结果 ↓ --&gt;</span>
<span class="token comment">&lt;!-- &lt;div id=&quot;a&quot;&gt;&lt;/div&gt; --&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_9-vue3-移除了-v-on-native-修饰符"><a href="#_9-vue3-移除了-v-on-native-修饰符" class="header-anchor">#</a> 9. <code>vue3</code> 移除了 <code>v-on.native</code> 修饰符</h3> <p>在 <code>vue2</code> 中， 我们想在父组件监听子组件的根节点事件， 我们就需要使用 <code>v-on.native</code> 修饰符。如下：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- vue2 写法 --&gt;</span>
<span class="token comment">&lt;!--parent.vue 父组件 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>child</span> <span class="token attr-name">@click.native</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleClick<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>child</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- vue2 写法 --&gt;</span>
<span class="token comment">&lt;!--child.vue 子组件 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tempalte</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>child<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tempalte</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这时 <code>@click.native</code> 就是监听 <code>class</code> 等于 <code>child</code> 节点的点击事件了。</p> <p>在 <code>vue3</code> 中移除了该修饰符 （<code>v-on.native</code> 修饰符）。</p> <p>如果仅仅这样写，那将相当于 <code>@click.native</code> 。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- vue3 写法 --&gt;</span>
<span class="token comment">&lt;!--parent.vue 父组件 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>child</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleClick<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>child</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>如果加上下面的代码, <code>handleClick</code> 函数将不会触发， 因为它会被认定为 <code>child.vue</code> 的回调函数，而下面的代码中没有定义 <code>click</code> 回调：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// vue3 写法</span>
<span class="token comment">// child.vue 子组件</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  emits<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'click'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>最后我们加上 <code>click</code> 回调, 这样触发 <code>aa</code> 函数的时候， <code>handleClick</code> 也会触发， 但是他不是 <code>click</code> 原生点击事件，只是子组件的回调：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// vue3 写法</span>
<span class="token comment">// child.vue 子组件</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getCurrentInstance <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  emits<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'click'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> emit <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">getCurrentInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">aa</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">aa</span><span class="token punctuation">(</span>emit<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">aa</span> <span class="token punctuation">(</span><span class="token parameter">emit</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="_10-vue3-中-ref-更改"><a href="#_10-vue3-中-ref-更改" class="header-anchor">#</a> 10. <code>vue3</code> 中 <code>ref=&quot;&quot;</code> 更改</h3> <p>在 <code>vue2</code> 中，我们可以通过往元素标签上添加 <code>ref</code> 属性来获取相应的标签 <code>dom</code> 值。如下：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- vue2 写法 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>div<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(item, index) in [1, 2, 3]<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>li<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ item }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// vue2 写法</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>div<span class="token punctuation">)</span>
    <span class="token comment">// div 元素</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>li<span class="token punctuation">)</span>
    <span class="token comment">// [li ,li ,li] li元素的数组</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>而在 <code>vue3</code> 中， <code>ref</code> 接收一个函数，函数的参数就是他的 <code>dom</code> 元素。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- vue3 写法 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">:ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>divFn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(item, index) in [1, 2, 3]<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>liFn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ item }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// vue3 写法</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token function-variable function">divFn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>
      <span class="token comment">// 输出 div 元素</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> <span class="token function-variable function">liFn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>
      <span class="token comment">// 输出每一个 li 元素</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      divFn<span class="token punctuation">,</span>
      liFn
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="_11-渲染函数更改"><a href="#_11-渲染函数更改" class="header-anchor">#</a> 11. 渲染函数更改</h3> <p>在 <code>vue2</code> 中， 我们可以这样使用渲染函数， 这样我们不需要 <code>html</code> 结构了。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// Vue 2 渲染函数示例</span>
<span class="token comment">// child.vue</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">h</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>从 <code>vue3</code> 开始， <code>h</code> 将是全局导入， 而不是作为参数传递给渲染函数。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// Vue 3 渲染函数示例</span>
<span class="token comment">// child.vue</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> h <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>使用 <code>h</code> 函数我们可以轻易的将Vue组件转为 <code>dom</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> h<span class="token punctuation">,</span> render <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token comment">// 传入 Message 组件</span>
<span class="token keyword">import</span> Message <span class="token keyword">from</span> <span class="token string">'./components/Message.vue'</span>

<span class="token keyword">function</span> <span class="token function">createEl</span> <span class="token punctuation">(</span><span class="token parameter">Component<span class="token punctuation">,</span> props<span class="token punctuation">,</span> children</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> vnode <span class="token operator">=</span> <span class="token function">h</span><span class="token punctuation">(</span>Component<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token operator">...</span>props <span class="token punctuation">}</span><span class="token punctuation">,</span> children<span class="token punctuation">)</span>
  <span class="token function">render</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> vnode<span class="token punctuation">.</span>el
<span class="token punctuation">}</span>


<span class="token keyword">const</span> el <span class="token operator">=</span> <span class="token function">createEl</span><span class="token punctuation">(</span>Message<span class="token punctuation">)</span>

document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="_12-自定义指令的生命周期进行了更改"><a href="#_12-自定义指令的生命周期进行了更改" class="header-anchor">#</a> 12. 自定义指令的生命周期进行了更改</h3> <p>这样一来，指令的生命周期和组件的生命周期 是相似的， 也是更加好理解的。</p> <table><thead><tr><th>Vue2.X指令生命周期</th> <th style="text-align:center;">Vue3.X对应的指令生命周期</th></tr></thead> <tbody><tr><td>bind</td> <td style="text-align:center;">beforeMount</td></tr> <tr><td>inserted</td> <td style="text-align:center;">mounted</td></tr> <tr><td>新的</td> <td style="text-align:center;"><span style="font-weight:600;color:#d73a49;">beforeUpdate</span></td></tr> <tr><td><span style="text-decoration:line-through;">update</span></td> <td style="text-align:center;">移除了</td></tr> <tr><td>componentUpdated</td> <td style="text-align:center;">updated</td></tr> <tr><td>新的</td> <td style="text-align:center;"><span style="font-weight:600;color:#d73a49;">beforeUnmount</span></td></tr> <tr><td>unbind</td> <td style="text-align:center;">unmounted</td></tr></tbody></table> <p><strong>当然， <code>vue3.x</code> 的更改不止这些，还有很多很多细节的东西。之后会详细记录我学习这些细节的东西。</strong></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">10/14/2022, 4:05:31 PM</span></div></footer> <!----> </main></div><div class="global-ui"><div class="footer-box" style="padding-left:20rem;" data-v-497fb04d><div class="footer-left" data-v-497fb04d><h2 class="footer-title" data-v-497fb04d><span class="logo-icon" data-v-497fb04d><img src="/vuepress-blog-lxh/assets/img/logo.664df77c.svg" data-v-497fb04d></span>
      江湖录 | <span class="small-tip" data-v-497fb04d>孤独的人的江湖路</span></h2> <p data-v-497fb04d>本站点所有图片图标资源尽皆都是百度来的， 如有侵权，立删！</p> <p data-v-497fb04d>联系email: lxhaweb@163.com</p></div> <div class="footer-right" data-v-497fb04d></div></div><!----></div></div>
    <script src="/vuepress-blog-lxh/assets/js/app.8d32188a.js" defer></script><script src="/vuepress-blog-lxh/assets/js/2.ae6c3983.js" defer></script><script src="/vuepress-blog-lxh/assets/js/33.d86bcecd.js" defer></script><script src="/vuepress-blog-lxh/assets/js/6.b516d596.js" defer></script>
  </body>
</html>
